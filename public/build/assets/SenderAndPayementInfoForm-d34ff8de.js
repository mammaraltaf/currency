import{K as se,r as c,k as ie,A as ue,c as b,a as n,u as t,w as i,b as p,H as z,O as G,o as f,n as H,g as k,l as ce,t as x,f as K}from"./app-dde26467.js";import{_ as M,V as Q}from"./vue-tel-input-50a09d25.js";import{u as me}from"./useAPI-162a5f74.js";import{c as W}from"./countries-4c15b513.js";import{c as X}from"./currencies_countries-fbccd8be.js";import{u as de}from"./notification-8eb2a074.js";import{_ as s}from"./NewTextInput-ecde88cf.js";import{_ as w}from"./NewSelectInput-67f8f5a4.js";import{_ as q}from"./FiftyText-6848784f.js";import{N as Y}from"./NewActionButton-f21ab536.js";import{_ as pe}from"./NewTextArea-b05879f4.js";import{_ as fe}from"./Spinner-b5a8aca4.js";/* empty css                                                     */import"./_plugin-vue_export-helper-c27b6911.js";/* empty css                                                */const _e={class:"sender-info-form-wrapper"},ve={class:"receiver-info-form-wrapper"},ye={key:0,class:"receiver-gets-wrapper m-auto"},be={class:"receiver-gets"},ge={key:1,class:"amount"},Ve={key:0,class:"receiver-gets-wrapper m-auto"},he={class:"receiver-gets"},Ce={class:"amount"},ke={class:"action-buttons"},xe={name:"SenderInfo"},Re=Object.assign(xe,{props:{transactionId:{required:!1,type:String},user:{default:null,type:Object},commissions:{default:null,type:Object},receivingCountries:{required:!0,default:[],type:Array}},emits:["stepChanged"],setup(Z,{emit:we}){const u=Z;console.log("commissions",u.commissions);const a=me(),g=de(),V=se().props.geoDetails,h=c(!1),C=c(0),U=c(!1),I=c(!1),_=c([]),r=ie({first_name:"",country:V.country_code,last_name:"",email:"",phone:"",amount:"",amountTotal:"",currency:X[V.country_code],receiver_first_name:"",receiver_last_name:"",receiver_email:"",receiver_phone:"",receiver_country:"",receiver_bank_id:"",receiver_account_number:"",receiver_branch_number:"",receiver_banking_info:"",flag:"send_now"}),ee=async()=>{h.value=!0;const l=u.receivingCountries.find(e=>e.code_iso_2===r.receiver_country||e.code===r.receiver_country);try{const e=await axios.post("/api/convert-currency",{baseCurrency:r.currency,requiredCurrency:l.currency.code});C.value=e==null?void 0:e.data[l.currency.code].value}catch{g.notify("Exchange rate is not available at the moment..","error")}finally{h.value=!1}},re=async l=>{l.preventDefault(),a.startRequest(),console.log("user",r),r.amountTotal=v.value.toString();try{(await axios.post("/api/validate-info",{...r,transactionId:u.transactionId})).data.status==="success"&&G.get("/verify-contacts?source="+(u.transactionId??"direct"))}catch(e){g.notify("Something went wrong...","error"),a.handleErrors(e)}finally{a.requestCompleted()}},oe=ue(()=>parseFloat((C.value*r.amount).toFixed(2))),N=l=>{r.phone="+"+l.dialCode},te=()=>{G.visit("/")};let v=c(0);function ae(){I.value=!0;let l=parseFloat(r.amount);for(const e of u.commissions)console.log("props.commissions",u.commissions),l>parseFloat(e.from)&&l<=parseFloat(e.to)&&(console.log("range.amount)",e.amount),l=l+parseFloat(e.amount));return console.log("total",l),v.value=l,{totalValue:v}}const ne=async()=>{a.startRequest();let l=r.receiver_country;console.log("country",l);try{const e=await axios.get("/api/get-international-banks?country_code="+l);console.log("res.banks",e),e.data.status=="success"&&(_.value=[],console.log("res.banks",e.banks),e.data.banks.forEach(m=>{_.value.push({label:m.label,value:m.id})}),console.log("bankoptions",_.value),ee())}catch(e){g.notify("Something went wrong...","error"),a.handleErrors(e)}finally{a.requestCompleted()}};return(l,e)=>{var m,A,B,F,T,E,L,O,S,D,$,j,R,P,J;return f(),b("div",_e,[n(s,{modelValue:r.first_name,"onUpdate:modelValue":e[0]||(e[0]=o=>r.first_name=o),errors:(m=t(a).errors.value)==null?void 0:m.first_name,label:"First Name",placeholder:"John",required:"",title:"first_name",class:"sender-input"},null,8,["modelValue","errors"]),n(s,{modelValue:r.last_name,"onUpdate:modelValue":e[1]||(e[1]=o=>r.last_name=o),errors:(A=t(a).errors.value)==null?void 0:A.last_name,label:"Last Name",placeholder:"Doe",required:"",title:"last_name",class:"sender-input"},null,8,["modelValue","errors"]),n(s,{modelValue:r.email,"onUpdate:modelValue":e[2]||(e[2]=o=>r.email=o),errors:(B=t(a).errors.value)==null?void 0:B.email,label:"Email",placeholder:"john@example.com",required:"",title:"email",class:"sender-input"},null,8,["modelValue","errors"]),n(M,{errors:(F=t(a).errors.value)==null?void 0:F.phone,required:!0,label:"Phone Number",title:"phone",class:"sender-input"},{default:i(()=>{var o,d,y;return[n(t(Q),{id:"exampleFormControlInput1",ref:"input",modelValue:r.phone,"onUpdate:modelValue":e[3]||(e[3]=le=>r.phone=le),class:H([{"error-border":((d=(o=t(a).errors.value)==null?void 0:o.phone)==null?void 0:d.length)>0},"form-control block w-full px-0 py-0 text-lg font-normal h-10 text-gray-700 bg-white bg-clip-padding border border-solid border-gray-300 rounded transition ease-linear m-0 focus:text-gray-700 focus:bg-white focus:border-indigo-300 focus:outline-none"]),defaultCountry:(y=t(V))==null?void 0:y.country_code,inputOptions:{placeholder:"123456789"},mode:"international",onCountryChanged:N},null,8,["modelValue","class","defaultCountry"])]}),_:1},8,["errors"]),n(s,{modelValue:r.amount,"onUpdate:modelValue":[e[4]||(e[4]=o=>r.amount=o),ae],disabled:U.value,errors:(T=t(a).errors.value)==null?void 0:T.amount,label:"Amount",placeholder:"99",required:"",title:"amount",class:"fifty-form-input",type:"number"},null,8,["modelValue","disabled","errors"]),n(w,{modelValue:r.country,"onUpdate:modelValue":e[5]||(e[5]=o=>r.country=o),errors:(E=t(a).errors.value)==null?void 0:E.country,options:t(W),disabled:"",label:"Country",placeholder:"Country",required:"",title:"country",type:"text",class:"fifty-form-input"},null,8,["modelValue","errors","options"]),n(q,{variation:"heading-3"},{default:i(()=>[k(" Enter Receiver Information ")]),_:1}),p("div",ve,[n(s,{class:"fifty-form-input",modelValue:r.receiver_first_name,"onUpdate:modelValue":e[6]||(e[6]=o=>r.receiver_first_name=o),errors:(L=t(a).errors.value)==null?void 0:L.receiver_first_name,label:"First Name",placeholder:"John",required:"",title:"first_name"},null,8,["modelValue","errors"]),n(s,{class:"fifty-form-input",modelValue:r.receiver_last_name,"onUpdate:modelValue":e[7]||(e[7]=o=>r.receiver_last_name=o),errors:(O=t(a).errors.value)==null?void 0:O.receiver_last_name,label:"Last Name",placeholder:"Doe",required:"",title:"last_name"},null,8,["modelValue","errors"]),n(s,{class:"fifty-form-input",modelValue:r.receiver_email,"onUpdate:modelValue":e[8]||(e[8]=o=>r.receiver_email=o),errors:(S=t(a).errors.value)==null?void 0:S.receiver_email,label:"Email",placeholder:"john@example.com",title:"email"},null,8,["modelValue","errors"]),n(M,{errors:(D=t(a).errors.value)==null?void 0:D.phone,required:!1,label:"Phone Number",title:"phone",class:"fifty-form-input"},{default:i(()=>{var o,d;return[n(t(Q),{id:"exampleFormControlInput1",ref:"input",modelValue:r.receiver_phone,"onUpdate:modelValue":e[9]||(e[9]=y=>r.receiver_phone=y),class:H([{"error-border":((d=(o=t(a).errors.value)==null?void 0:o.receiver_phone)==null?void 0:d.length)>0},"form-control block w-full px-0 py-0 text-lg font-normal h-10 text-gray-700 bg-white bg-clip-padding border border-solid border-gray-300 rounded transition ease-linear m-0 focus:text-gray-700 focus:bg-white focus:border-indigo-300 focus:outline-none"]),inputOptions:{placeholder:"123456789"},onlyCountries:U.value?[r.receiver_country]:[],mode:"international",onCountryChanged:N},null,8,["modelValue","class","onlyCountries"])]}),_:1},8,["errors"]),n(w,{class:"fifty-form-input",modelValue:r.receiver_country,"onUpdate:modelValue":[e[10]||(e[10]=o=>r.receiver_country=o),ne],errors:($=t(a).errors.value)==null?void 0:$.receiver_country,options:t(W),label:"Country",placeholder:"Country",required:"",title:"country",type:"text"},null,8,["modelValue","errors","options"]),n(w,{class:"fifty-form-input",modelValue:r.receiver_bank_id,"onUpdate:modelValue":e[11]||(e[11]=o=>r.receiver_bank_id=o),errors:(j=t(a).errors.value)==null?void 0:j.receiver_bank_id,options:_.value,label:"International Bank",placeholder:"International Bank",required:"",title:"bank",type:"text"},null,8,["modelValue","errors","options"]),n(s,{class:"fifty-form-input",modelValue:r.receiver_account_number,"onUpdate:modelValue":e[12]||(e[12]=o=>r.receiver_account_number=o),errors:(R=t(a).errors.value)==null?void 0:R.receiver_account_number,label:"Account Number",placeholder:"123456789",required:"",title:"account_number"},null,8,["modelValue","errors"]),n(s,{class:"fifty-form-input",modelValue:r.receiver_branch_number,"onUpdate:modelValue":e[13]||(e[13]=o=>r.receiver_branch_number=o),errors:(P=t(a).errors.value)==null?void 0:P.receiver_branch_number,label:"Branch Number",placeholder:"123456789",title:"branch_number"},null,8,["modelValue","errors"]),n(pe,{modelValue:r.receiver_banking_info,"onUpdate:modelValue":e[14]||(e[14]=o=>r.receiver_banking_info=o),errors:(J=t(a).errors.value)==null?void 0:J.receiver_banking_info,label:"Additional Information / Comments",placeholder:"I am open to different payment options...",title:"banking_info"},null,8,["modelValue","errors"])]),n(z,{mode:"out-in",name:"fade"},{default:i(()=>[C.value&&r.amount?(f(),b("div",ye,[p("div",be,[n(q,{class:"title"},{default:i(()=>[k(" The receiver will get approximately ")]),_:1}),h.value?(f(),ce(fe,{key:0})):(f(),b("div",ge,x(t(oe))+" "+x(t(X)[r.receiver_country]),1))])])):K("",!0)]),_:1}),n(z,{mode:"out-in",name:"fade"},{default:i(()=>[I.value?(f(),b("div",Ve,[p("div",he,[n(q,{class:"title"},{default:i(()=>[k(" Total Amount ")]),_:1}),p("div",Ce,x(t(v)+" "+r.currency),1)])])):K("",!0)]),_:1}),p("div",ke,[n(Y,{reversed:!0,type:"button",title:"Cancel",onClick:te}),n(Y,{isLoading:t(a).isLoading.value,title:"Continue",onClick:re},null,8,["isLoading"])])])}}});export{Re as default};
